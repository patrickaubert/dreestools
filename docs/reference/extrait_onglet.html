<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fonction extrayant le contenu d'un onglet d'un fichier Excel diffusé sur data.drees — extrait_onglet • dreestools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fonction extrayant le contenu d'un onglet d'un fichier Excel diffusé sur data.drees — extrait_onglet" />
<meta property="og:description" content="Cette fonction sert à extraire le contenu d'un onglet d'un fichier Excel diffusé sous data.Drees.
Le produit est une liste contenant un élément &quot;tab&quot; correspondant au tableau de données,
et divers éléments correspondant aux métadonnées (&quot;source&quot;,&quot;note&quot;,&quot;champ&quot;, etc.)" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dreestools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fonction extrayant le contenu d'un onglet d'un fichier Excel diffusé sur data.drees</h1>
    
    <div class="hidden name"><code>extrait_onglet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Cette fonction sert à extraire le contenu d'un onglet d'un fichier Excel diffusé sous data.Drees.
Le produit est une liste contenant un élément "tab" correspondant au tableau de données,
et divers éléments correspondant aux métadonnées ("source","note","champ", etc.)</p>
    </div>

    <pre class="usage"><span class='fu'>extrait_onglet</span><span class='op'>(</span><span class='va'>file</span>, <span class='va'>sheet</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>nom du fichier Excel</p></td>
    </tr>
    <tr>
      <th>sheet</th>
      <td><p>nom de l'onglet</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>une liste contenant un tableau de donnée (élément "tab") et des métadonnées (éléments "intitule","numtab","source","champ", etc.)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Nota : Cette fonction a initialement été dupliquée à partir de la fonction readSheetExcel du package asdep, mais elle intègre quelques améliorations.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>tab_et_infos</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"549_la-prestation-de-compensation-du-handicap-pch"</span>,<span class='st'>"pch_et_actp_beneficiaires_par_sexe_et_age_montants_verses_donnees_2016.xlsx"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"Tableau 1"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("549_la-prestation-de-compensation-du-handicap-pch",     "pch_et_actp_beneficiaires_par_sexe_et_age_montants_verses_donnees_2016.xlsx"),     sheet = "Tableau 1"): impossible de trouver la fonction "extrait_onglet"</span></div><div class='input'><span class='va'>tab_et_infos2</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"376_les-depenses-d-aide-sociale-departementale"</span>,<span class='st'>"les_depenses_daide_sociale_departementale_series_longues_1999_2018.xlsx"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"DonnÃ©es nationales"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("376_les-depenses-d-aide-sociale-departementale",     "les_depenses_daide_sociale_departementale_series_longues_1999_2018.xlsx"),     sheet = "DonnÃ©es nationales"): impossible de trouver la fonction "extrait_onglet"</span></div><div class='input'><span class='va'>tab_et_infos3</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"336_minima-sociaux-rsa-et-prime-d-activite"</span>,<span class='st'>"rsa_et_prime_d_activites_donnees_par_sexe_et_configuration_familiale_xlsx"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"Tableau 2"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("336_minima-sociaux-rsa-et-prime-d-activite",     "rsa_et_prime_d_activites_donnees_par_sexe_et_configuration_familiale_xlsx"),     sheet = "Tableau 2"): impossible de trouver la fonction "extrait_onglet"</span></div><div class='input'><span class='va'>tab4</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"619_indicateurs-financiers"</span>,<span class='st'>"fi09_fi10_isd_depenses_d_aide_a_l_hebergement_des_personnes_handicapees_en_etablissement_xlsx"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"2017"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>tab</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("619_indicateurs-financiers",     "fi09_fi10_isd_depenses_d_aide_a_l_hebergement_des_personnes_handicapees_en_etablissement_xlsx"),     sheet = "2017"): impossible de trouver la fonction "extrait_onglet"</span></div><div class='input'><span class='va'>tab5</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"donnees-mensuelles-sur-les-prestations-de-solidarite"</span>,<span class='st'>"donnees_mensuelles_prestations_solidarite_janvier2021_mm_xlsx"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"Tableau 1"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>tab</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("donnees-mensuelles-sur-les-prestations-de-solidarite",     "donnees_mensuelles_prestations_solidarite_janvier2021_mm_xlsx"),     sheet = "Tableau 1"): impossible de trouver la fonction "extrait_onglet"</span></div><div class='input'><span class='va'>tab6</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"4230_indicateurs-de-pauvrete-avant-et-apres-redistribution-de-niveau-de-vie-et-d"</span>,<span class='st'>"series_longues_d_indicateurs_de_pauvrete_xlsx"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"Tableau 1a"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>tab</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("4230_indicateurs-de-pauvrete-avant-et-apres-redistribution-de-niveau-de-vie-et-d",     "series_longues_d_indicateurs_de_pauvrete_xlsx"), sheet = "Tableau 1a"): impossible de trouver la fonction "extrait_onglet"</span></div><div class='input'><span class='va'>tab_et_infos7</span> <span class='op'>&lt;-</span> <span class='fu'>extrait_onglet</span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'><a href='pathdatadrees.html'>pathdatadrees</a></span><span class='op'>(</span><span class='st'>"2034_la-retraite-supplementaire-facultative-et-l-epargne-retraite"</span>,<span class='st'>"la_retraite_supplementaire_donnees_jusquau_31_decembre_2018xls"</span><span class='op'>)</span>, sheet<span class='op'>=</span><span class='st'>"30-T1"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in extrait_onglet(file = pathdatadrees("2034_la-retraite-supplementaire-facultative-et-l-epargne-retraite",     "la_retraite_supplementaire_donnees_jusquau_31_decembre_2018xls"),     sheet = "30-T1"): impossible de trouver la fonction "extrait_onglet"</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://sites.google.com/site/patrickauber/'>Patrick Aubert</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


